# Chorus 配置示例文件
# 展示如何配置 temperature 参数以及新的 workflow JSON 格式

[server]
host = "127.0.0.1"
port = 11435

# 示例1：使用固定的 temperature 值
[[model]]
api_base = "https://apis.iflow.cn/v1"
api_key = "your-api-key-here"
name = "qwen3-max"
temperature = 0.8  # 固定使用 0.8 的 temperature

# 示例2：启用自动 temperature 选择
[[model]]
api_base = "https://apis.iflow.cn/v1"
api_key = "your-api-key-here"
name = "glm-4.6"
auto_temperature = true  # 由分析器模型自动决定 temperature

# 示例3：使用默认行为（不设置任何 temperature 参数）
[[model]]
api_base = "https://apis.iflow.cn/v1"
api_key = "your-api-key-here"
name = "deepseek-v3.2"
# 不设置 temperature 和 auto_temperature，将使用默认值 1.4

# 示例4：同时设置两个参数（temperature 优先级更高）
[[model]]
api_base = "https://apis.iflow.cn/v1"
api_key = "your-api-key-here"
name = "kimi-k2-0905"
temperature = 0.5  # 固定值优先，auto_temperature 会被忽略
auto_temperature = true

# 新格式：将 workflow 结构存储为 JSON 字符串
[workflow-integration]
json = """{
  "analyzer": {
    "ref": "glm-4.6",
    "auto_temperature": true
  },
  "workers": [
    {
      "name": "deepseek-v3.2",
      "temperature": 1
    },
    {
      "analyzer": {
        "ref": "glm-4.6",
        "auto_temperature": true
      },
      "workers": [
        {
          "name": "kimi-k2-0905",
          "temperature": 1
        },
        {
          "name": "deepseek-v3.2",
          "temperature": 1
        },
        {
          "name": "glm-4.6",
          "temperature": 1
        },
        {
          "analyzer": {
            "ref": "glm-4.6",
            "auto_temperature": true
          },
          "workers": [
            {
              "name": "qwen3-coder",
              "temperature": 1
            },
            {
              "name": "deepseek-v3.1",
              "temperature": 1
            },
            {
              "name": "qwen3-max",
              "temperature": 1
            }
          ],
          "synthesizer": {
            "ref": "qwen3-max"
          }
        }
      ],
      "synthesizer": {
        "ref": "qwen3-max"
      }
    }
  ],
  "synthesizer": {
    "ref": "qwen3-max"
  },
  "selector": {
    "ref": "qwen3-max"
  }
}"""

[workflow.timeouts]
# 所有超时时间单位均为秒
analyzer_timeout_secs = 30
worker_timeout_secs = 60
synthesizer_timeout_secs = 60

# 域名超时覆盖示例
[workflow.domains]
[workflow.domains."api.example.com"]
analyzer_timeout_secs = 40
worker_timeout_secs = 80

[workflow.domains."app.example.com"]
analyzer_timeout_secs = 20
synthesizer_timeout_secs = 30

# Temperature 配置说明：
# 
# 1. temperature (可选)
#    - 类型：浮点数 (0.0 - 2.0)
#    - 说明：设置模型的温度参数
#    - 效果：
#      * 0.0-0.3: 非常确定和保守的输出，适合需要精确答案的场景
#      * 0.4-0.7: 平衡的输出，适合大多数场景
#      * 0.8-1.2: 更有创造性的输出，适合创意写作等场景
#      * 1.3-2.0: 非常随机和创造性的输出
#
# 2. auto_temperature (可选)
#    - 类型：布尔值 (true/false)
#    - 默认值：false
#    - 说明：是否让分析器模型自动决定最佳 temperature
#    - 效果：
#      * true: 分析器会根据用户提示的特点自动选择合适的 temperature
#      * false: 使用配置的 temperature 值或默认值 1.4
#
# 3. 优先级规则：
#    - 如果设置了 temperature，则使用该固定值（忽略 auto_temperature）
#    - 如果没有设置 temperature 但 auto_temperature = true，则由分析器决定
#    - 如果两者都没设置，则使用默认值 1.4
